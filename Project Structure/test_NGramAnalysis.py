######################################
import unittest

from modules.metadata import metadata
from modules.tokenizer import tokenizer
from modules.ngram_analysis import ngram_analysis

class TestNGramAnalysis(unittest.TestCase):
    def test_ngram_analysis(self):
        #test 1
        #testing the alice_smith_cat_story
        input_data = tokenizer(metadata({"doc": "tests/Alice_Smith_Cat_Story.docx"}))
        result = ngram_analysis(input_data)
        expected_result = {'metadata': {'author': 'Alice Smith', 'category': 'Story', 'comments': 'This is a story about a curious cat named Mittens.', 'content_status': 'Draft', 'created': '2013-12-23T23:15:00', 'identifier': '12345678-1234-1234-1234-123456789012', 'keywords': 'cat, story, adventure', 'language': 'en-US', 'last_modified_by': 'Alice Smith', 'last_printed': None, 'modified': '2013-12-23T23:15:00', 'revision': 1, 'subject': "A Cat's Adventure", 'title': 'fluttering butterfly outside the window.', 'version': '1.0', 'name': 'tests/Alice_Smith_Cat_Story.docx', 'paragraphs': ["Alice Smith's Cat", 'In a cozy little house nestled amidst the bustling city, lived a ginger cat named Mittens, the beloved companion of Alice Smith. She was known for her playful antics and insatiable curiosity. One sunny afternoon, while basking in a patch of warm sunlight, Mittens spotted a fluttering butterfly outside the window. She leaped off the window sill, tail swishing excitedly, and darted towards the fluttering wings. Mittens pounced and batted at the butterfly with her paws, but the nimble creature fluttered away, leaving her wanting more. Undeterred, Mittens continued to explore the house, searching for new adventures.'], 'text': "Alice Smith's Cat In a cozy little house nestled amidst the bustling city, lived a ginger cat named Mittens, the beloved companion of Alice Smith. She was known for her playful antics and insatiable curiosity. One sunny afternoon, while basking in a patch of warm sunlight, Mittens spotted a fluttering butterfly outside the window. She leaped off the window sill, tail swishing excitedly, and darted towards the fluttering wings. Mittens pounced and batted at the butterfly with her paws, but the nimble creature fluttered away, leaving her wanting more. Undeterred, Mittens continued to explore the house, searching for new adventures."}, 'tokens': ['alice', 'smiths', 'cat', 'in', 'a', 'cozy', 'little', 'house', 'nestled', 'amidst', 'the', 'bustling', 'city', 'lived', 'a', 'ginger', 'cat', 'named', 'mittens', 'the', 'beloved', 'companion', 'of', 'alice', 'smith', 'she', 'was', 'known', 'for', 'her', 'playful', 'antics', 'and', 'insatiable', 'curiosity', 'one', 'sunny', 'afternoon', 'while', 'basking', 'in', 'a', 'patch', 'of', 'warm', 'sunlight', 'mittens', 'spotted', 'a', 'fluttering', 'butterfly', 'outside', 'the', 'window', 'she', 'leaped', 'off', 'the', 'window', 'sill', 'tail', 'swishing', 'excitedly', 'and', 'darted', 'towards', 'the', 'fluttering', 'wings', 'mittens', 'pounced', 'and', 'batted', 'at', 'the', 'butterfly', 'with', 'her', 'paws', 'but', 'the', 'nimble', 'creature', 'fluttered', 'away', 'leaving', 'her', 'wanting', 'more', 'undeterred', 'mittens', 'continued', 'to', 'explore', 'the', 'house', 'searching', 'for', 'new', 'adventures'], 'top_ngrams': [(('alice', 'smiths'), 1), (('smiths', 'cat'), 1), (('cat', 'cozy'), 1), (('cozy', 'little'), 1), (('little', 'house'), 1), (('house', 'nestled'), 1), (('nestled', 'amidst'), 1), (('amidst', 'bustling'), 1), (('bustling', 'city'), 1), (('city', 'lived'), 1), (('lived', 'ginger'), 1), (('ginger', 'cat'), 1), (('cat', 'named'), 1), (('named', 'mittens'), 1), (('mittens', 'beloved'), 1), (('beloved', 'companion'), 1), (('companion', 'alice'), 1), (('alice', 'smith'), 1), (('smith', 'known'), 1), (('known', 'playful'), 1), (('playful', 'antics'), 1), (('antics', 'insatiable'), 1), (('insatiable', 'curiosity'), 1), (('curiosity', 'one'), 1), (('one', 'sunny'), 1), (('sunny', 'afternoon'), 1), (('afternoon', 'basking'), 1), (('basking', 'patch'), 1), (('patch', 'warm'), 1), (('warm', 'sunlight'), 1), (('sunlight', 'mittens'), 1), (('mittens', 'spotted'), 1), (('spotted', 'fluttering'), 1), (('fluttering', 'butterfly'), 1), (('butterfly', 'outside'), 1), (('outside', 'window'), 1), (('window', 'leaped'), 1), (('leaped', 'window'), 1), (('window', 'sill'), 1), (('sill', 'tail'), 1), (('tail', 'swishing'), 1), (('swishing', 'excitedly'), 1), (('excitedly', 'darted'), 1), (('darted', 'towards'), 1), (('towards', 'fluttering'), 1), (('fluttering', 'wings'), 1), (('wings', 'mittens'), 1), (('mittens', 'pounced'), 1), (('pounced', 'batted'), 1), (('batted', 'butterfly'), 1)]}
        self.assertEqual(result, expected_result)

        #test 2
        #testing the Bob_Johnson_Kitten_Story.docx
        input_data = tokenizer(metadata({"doc": "tests/Bob_Johnson_Kitten_Story.docx"}))
        result = ngram_analysis(input_data)
        expected_result = {'metadata': {'author': 'Bob Johnson', 'category': 'Animals', 'comments': 'This is a story about a mischievous kitten.', 'content_status': 'Draft', 'created': '2013-12-23T23:15:00', 'identifier': '98765432-1234-1234-1234-123456789012', 'keywords': 'cat, kitten, mischievous', 'language': 'en-US', 'last_modified_by': 'Bob Johnson', 'last_printed': None, 'modified': '2013-12-23T23:15:00', 'revision': 1, 'subject': "A Kitten's Antics", 'title': "Bob Johnson's Kitten", 'version': '1.0', 'name': 'tests/Bob_Johnson_Kitten_Story.docx', 'paragraphs': ["Bob Johnson's Kitten", "In a quaint farmhouse surrounded by rolling hills, lived a fluffy white kitten named Snowball, the playful companion of Bob Johnson. He was known for his insatiable curiosity and mischievous energy. One crisp autumn morning, while chasing a dust bunny across the living room floor, Snowball stumbled upon a ball of yarn left unattended. Entranced by the colorful strands, he pounced and batted at the yarn, unraveling it in a frenzy. He chased the loose yarn around the room, leaving a trail of tangled threads in his wake. Bob chuckled as he watched the kitten's playful chaos, knowing he would need to gather the yarn before it became another casualty of Snowball's adventures."], 'text': "Bob Johnson's Kitten In a quaint farmhouse surrounded by rolling hills, lived a fluffy white kitten named Snowball, the playful companion of Bob Johnson. He was known for his insatiable curiosity and mischievous energy. One crisp autumn morning, while chasing a dust bunny across the living room floor, Snowball stumbled upon a ball of yarn left unattended. Entranced by the colorful strands, he pounced and batted at the yarn, unraveling it in a frenzy. He chased the loose yarn around the room, leaving a trail of tangled threads in his wake. Bob chuckled as he watched the kitten's playful chaos, knowing he would need to gather the yarn before it became another casualty of Snowball's adventures."}, 'tokens': ['bob', 'johnsons', 'kitten', 'in', 'a', 'quaint', 'farmhouse', 'surrounded', 'by', 'rolling', 'hills', 'lived', 'a', 'fluffy', 'white', 'kitten', 'named', 'snowball', 'the', 'playful', 'companion', 'of', 'bob', 'johnson', 'he', 'was', 'known', 'for', 'his', 'insatiable', 'curiosity', 'and', 'mischievous', 'energy', 'one', 'crisp', 'autumn', 'morning', 'while', 'chasing', 'a', 'dust', 'bunny', 'across', 'the', 'living', 'room', 'floor', 'snowball', 'stumbled', 'upon', 'a', 'ball', 'of', 'yarn', 'left', 'unattended', 'entranced', 'by', 'the', 'colorful', 'strands', 'he', 'pounced', 'and', 'batted', 'at', 'the', 'yarn', 'unraveling', 'it', 'in', 'a', 'frenzy', 'he', 'chased', 'the', 'loose', 'yarn', 'around', 'the', 'room', 'leaving', 'a', 'trail', 'of', 'tangled', 'threads', 'in', 'his', 'wake', 'bob', 'chuckled', 'as', 'he', 'watched', 'the', 'kittens', 'playful', 'chaos', 'knowing', 'he', 'would', 'need', 'to', 'gather', 'the', 'yarn', 'before', 'it', 'became', 'another', 'casualty', 'of', 'snowballs', 'adventures'], 'top_ngrams': [(('bob', 'johnsons'), 1), (('johnsons', 'kitten'), 1), (('kitten', 'quaint'), 1), (('quaint', 'farmhouse'), 1), (('farmhouse', 'surrounded'), 1), (('surrounded', 'rolling'), 1), (('rolling', 'hills'), 1), (('hills', 'lived'), 1), (('lived', 'fluffy'), 1), (('fluffy', 'white'), 1), (('white', 'kitten'), 1), (('kitten', 'named'), 1), (('named', 'snowball'), 1), (('snowball', 'playful'), 1), (('playful', 'companion'), 1), (('companion', 'bob'), 1), (('bob', 'johnson'), 1), (('johnson', 'known'), 1), (('known', 'insatiable'), 1), (('insatiable', 'curiosity'), 1), (('curiosity', 'mischievous'), 1), (('mischievous', 'energy'), 1), (('energy', 'one'), 1), (('one', 'crisp'), 1), (('crisp', 'autumn'), 1), (('autumn', 'morning'), 1), (('morning', 'chasing'), 1), (('chasing', 'dust'), 1), (('dust', 'bunny'), 1), (('bunny', 'across'), 1), (('across', 'living'), 1), (('living', 'room'), 1), (('room', 'floor'), 1), (('floor', 'snowball'), 1), (('snowball', 'stumbled'), 1), (('stumbled', 'upon'), 1), (('upon', 'ball'), 1), (('ball', 'yarn'), 1), (('yarn', 'left'), 1), (('left', 'unattended'), 1), (('unattended', 'entranced'), 1), (('entranced', 'colorful'), 1), (('colorful', 'strands'), 1), (('strands', 'pounced'), 1), (('pounced', 'batted'), 1), (('batted', 'yarn'), 1), (('yarn', 'unraveling'), 1), (('unraveling', 'frenzy'), 1), (('frenzy', 'chased'), 1), (('chased', 'loose'), 1)]}
        self.assertEqual(result, expected_result)

        #test 3
        #testing the Charlie_Brown_Cat.docx
        input_data = tokenizer(metadata({"doc": "tests/Charlie_Brown_Cat.docx"}))
        result = ngram_analysis(input_data)
        expected_result =  {'metadata': {'author': 'Charlie Brown', 'category': 'Fiction', 'comments': 'This is a story about a brave cat on a journey.', 'content_status': 'Draft', 'created': '2013-12-23T23:15:00', 'identifier': '11223344-1234-1234-1234-123456789012', 'keywords': 'cat, journey, brave', 'language': 'en-US', 'last_modified_by': 'Charlie Brown', 'last_printed': None, 'modified': '2013-12-23T23:15:00', 'revision': 1, 'subject': "The Cat's Quest", 'title': "Charlie Brown's Cat", 'version': '1.0', 'name': 'tests/Charlie_Brown_Cat.docx', 'paragraphs': ["Charlie Brown's Cat", 'In a charming little bookstore nestled down a quiet street, lived a sleek black cat named Midnight, the loyal companion of Charlie Brown. He was known for his quiet nature and adventurous spirit. One rainy afternoon, while exploring the city streets, Midnight stumbled upon an old map tucked away in a corner. The map depicted a mysterious island rumored to hold great treasures. Intrigued by the possibility of adventure, Midnight embarked on a perilous journey across stormy seas and treacherous terrain, facing danger and challenges at every turn. But with courage and determination, Midnight pressed on, guided by the promise of discovery and the hope of returning home a hero.'], 'text': "Charlie Brown's Cat In a charming little bookstore nestled down a quiet street, lived a sleek black cat named Midnight, the loyal companion of Charlie Brown. He was known for his quiet nature and adventurous spirit. One rainy afternoon, while exploring the city streets, Midnight stumbled upon an old map tucked away in a corner. The map depicted a mysterious island rumored to hold great treasures. Intrigued by the possibility of adventure, Midnight embarked on a perilous journey across stormy seas and treacherous terrain, facing danger and challenges at every turn. But with courage and determination, Midnight pressed on, guided by the promise of discovery and the hope of returning home a hero."}, 'tokens': ['charlie', 'browns', 'cat', 'in', 'a', 'charming', 'little', 'bookstore', 'nestled', 'down', 'a', 'quiet', 'street', 'lived', 'a', 'sleek', 'black', 'cat', 'named', 'midnight', 'the', 'loyal', 'companion', 'of', 'charlie', 'brown', 'he', 'was', 'known', 'for', 'his', 'quiet', 'nature', 'and', 'adventurous', 'spirit', 'one', 'rainy', 'afternoon', 'while', 'exploring', 'the', 'city', 'streets', 'midnight', 'stumbled', 'upon', 'an', 'old', 'map', 'tucked', 'away', 'in', 'a', 'corner', 'the', 'map', 'depicted', 'a', 'mysterious', 'island', 'rumored', 'to', 'hold', 'great', 'treasures', 'intrigued', 'by', 'the', 'possibility', 'of', 'adventure', 'midnight', 'embarked', 'on', 'a', 'perilous', 'journey', 'across', 'stormy', 'seas', 'and', 'treacherous', 'terrain', 'facing', 'danger', 'and', 'challenges', 'at', 'every', 'turn', 'but', 'with', 'courage', 'and', 'determination', 'midnight', 'pressed', 'on', 'guided', 'by', 'the', 'promise', 'of', 'discovery', 'and', 'the', 'hope', 'of', 'returning', 'home', 'a', 'hero'], 'top_ngrams': [(('charlie', 'browns'), 1), (('browns', 'cat'), 1), (('cat', 'charming'), 1), (('charming', 'little'), 1), (('little', 'bookstore'), 1), (('bookstore', 'nestled'), 1), (('nestled', 'quiet'), 1), (('quiet', 'street'), 1), (('street', 'lived'), 1), (('lived', 'sleek'), 1), (('sleek', 'black'), 1), (('black', 'cat'), 1), (('cat', 'named'), 1), (('named', 'midnight'), 1), (('midnight', 'loyal'), 1), (('loyal', 'companion'), 1), (('companion', 'charlie'), 1), (('charlie', 'brown'), 1), (('brown', 'known'), 1), (('known', 'quiet'), 1), (('quiet', 'nature'), 1), (('nature', 'adventurous'), 1), (('adventurous', 'spirit'), 1), (('spirit', 'one'), 1), (('one', 'rainy'), 1), (('rainy', 'afternoon'), 1), (('afternoon', 'exploring'), 1), (('exploring', 'city'), 1), (('city', 'streets'), 1), (('streets', 'midnight'), 1), (('midnight', 'stumbled'), 1), (('stumbled', 'upon'), 1), (('upon', 'old'), 1), (('old', 'map'), 1), (('map', 'tucked'), 1), (('tucked', 'away'), 1), (('away', 'corner'), 1), (('corner', 'map'), 1), (('map', 'depicted'), 1), (('depicted', 'mysterious'), 1), (('mysterious', 'island'), 1), (('island', 'rumored'), 1), (('rumored', 'hold'), 1), (('hold', 'great'), 1), (('great', 'treasures'), 1), (('treasures', 'intrigued'), 1), (('intrigued', 'possibility'), 1), (('possibility', 'adventure'), 1), (('adventure', 'midnight'), 1), (('midnight', 'embarked'), 1)]}
        self.assertEqual(result, expected_result)

        #test 4
        #testing the Jane_Doe_Cat_Story.docx
        input_data = tokenizer(metadata({"doc": "tests/Jane_Doe_Cat_Story.docx"}))
        result = ngram_analysis(input_data)
        expected_result =  {'metadata': {'author': 'Jane Doe', 'category': 'Story', 'comments': 'This is a story about a pampered cat.', 'content_status': 'Draft', 'created': '2013-12-23T23:15:00', 'identifier': '55555555-1234-1234-1234-123456789012', 'keywords': 'cat, pampered, story', 'language': 'en-US', 'last_modified_by': 'Jane Doe', 'last_printed': None, 'modified': '2013-12-23T23:15:00', 'revision': 1, 'subject': 'A Pampered Life', 'title': "Jane Doe's Cat", 'version': '1.0', 'name': 'tests/Jane_Doe_Cat_Story.docx', 'paragraphs': ["Jane Doe's Cat", 'In a luxurious apartment overlooking the bustling city, lived a Persian cat named Duchess, the prized possession of Jane Doe. She was known for her regal demeanor and sophisticated taste. Every morning, Duchess would be awakened by the gentle clinking of her silver food dish, filled with gourmet cat food. After a leisurely breakfast, she would spend her days lounging on plush cushions, basking in sunbeams, and occasionally batting at feather toys presented by her devoted owner. One afternoon, while perched on a window sill, Duchess observed a stray cat navigating the alleyway below. The stray, thin and scruffy, rummaged through a bin, searching for scraps. Duchess watched with a mixture of curiosity and disdain, her pampered life a stark contrast to the struggles of the alley cat.'], 'text': "Jane Doe's Cat In a luxurious apartment overlooking the bustling city, lived a Persian cat named Duchess, the prized possession of Jane Doe. She was known for her regal demeanor and sophisticated taste. Every morning, Duchess would be awakened by the gentle clinking of her silver food dish, filled with gourmet cat food. After a leisurely breakfast, she would spend her days lounging on plush cushions, basking in sunbeams, and occasionally batting at feather toys presented by her devoted owner. One afternoon, while perched on a window sill, Duchess observed a stray cat navigating the alleyway below. The stray, thin and scruffy, rummaged through a bin, searching for scraps. Duchess watched with a mixture of curiosity and disdain, her pampered life a stark contrast to the struggles of the alley cat."}, 'tokens': ['jane', 'does', 'cat', 'in', 'a', 'luxurious', 'apartment', 'overlooking', 'the', 'bustling', 'city', 'lived', 'a', 'persian', 'cat', 'named', 'duchess', 'the', 'prized', 'possession', 'of', 'jane', 'doe', 'she', 'was', 'known', 'for', 'her', 'regal', 'demeanor', 'and', 'sophisticated', 'taste', 'every', 'morning', 'duchess', 'would', 'be', 'awakened', 'by', 'the', 'gentle', 'clinking', 'of', 'her', 'silver', 'food', 'dish', 'filled', 'with', 'gourmet', 'cat', 'food', 'after', 'a', 'leisurely', 'breakfast', 'she', 'would', 'spend', 'her', 'days', 'lounging', 'on', 'plush', 'cushions', 'basking', 'in', 'sunbeams', 'and', 'occasionally', 'batting', 'at', 'feather', 'toys', 'presented', 'by', 'her', 'devoted', 'owner', 'one', 'afternoon', 'while', 'perched', 'on', 'a', 'window', 'sill', 'duchess', 'observed', 'a', 'stray', 'cat', 'navigating', 'the', 'alleyway', 'below', 'the', 'stray', 'thin', 'and', 'scruffy', 'rummaged', 'through', 'a', 'bin', 'searching', 'for', 'scraps', 'duchess', 'watched', 'with', 'a', 'mixture', 'of', 'curiosity', 'and', 'disdain', 'her', 'pampered', 'life', 'a', 'stark', 'contrast', 'to', 'the', 'struggles', 'of', 'the', 'alley', 'cat'], 'top_ngrams': [(('jane', 'cat'), 1), (('cat', 'luxurious'), 1), (('luxurious', 'apartment'), 1), (('apartment', 'overlooking'), 1), (('overlooking', 'bustling'), 1), (('bustling', 'city'), 1), (('city', 'lived'), 1), (('lived', 'persian'), 1), (('persian', 'cat'), 1), (('cat', 'named'), 1), (('named', 'duchess'), 1), (('duchess', 'prized'), 1), (('prized', 'possession'), 1), (('possession', 'jane'), 1), (('jane', 'doe'), 1), (('doe', 'known'), 1), (('known', 'regal'), 1), (('regal', 'demeanor'), 1), (('demeanor', 'sophisticated'), 1), (('sophisticated', 'taste'), 1), (('taste', 'every'), 1), (('every', 'morning'), 1), (('morning', 'duchess'), 1), (('duchess', 'would'), 1), (('would', 'awakened'), 1), (('awakened', 'gentle'), 1), (('gentle', 'clinking'), 1), (('clinking', 'silver'), 1), (('silver', 'food'), 1), (('food', 'dish'), 1), (('dish', 'filled'), 1), (('filled', 'gourmet'), 1), (('gourmet', 'cat'), 1), (('cat', 'food'), 1), (('food', 'leisurely'), 1), (('leisurely', 'breakfast'), 1), (('breakfast', 'would'), 1), (('would', 'spend'), 1), (('spend', 'days'), 1), (('days', 'lounging'), 1), (('lounging', 'plush'), 1), (('plush', 'cushions'), 1), (('cushions', 'basking'), 1), (('basking', 'sunbeams'), 1), (('sunbeams', 'occasionally'), 1), (('occasionally', 'batting'), 1), (('batting', 'feather'), 1), (('feather', 'toys'), 1), (('toys', 'presented'), 1), (('presented', 'devoted'), 1)]}
        self.assertEqual(result, expected_result)
        
        #test 5
        #testing the test_document5.docx  (an empty document)
        input_data = tokenizer(metadata({"doc": "tests/test_document5.docx"}))
        result = ngram_analysis(input_data)
        expected_result = {'metadata': {'author': '', 'category': '', 'comments': '', 'content_status': '', 'created': '2013-12-23T23:15:00', 'identifier': '', 'keywords': '', 'language': '', 'last_modified_by': '', 'last_printed': None, 'modified': '2013-12-23T23:15:00', 'revision': 1, 'subject': '', 'title': '', 'version': '', 'name': 'tests/test_document5.docx', 'paragraphs': [], 'text': ''}, 'tokens': [], 'top_ngrams': []}
        self.assertEqual(result, expected_result)

        #test 6
        #testing null
        input_data = tokenizer(metadata({"doc": None}))
        result = ngram_analysis(input_data)
        expected_result =  {'metadata': {'author': 'python-docx', 'category': '', 'comments': 'generated by python-docx', 'content_status': '', 'created': '2013-12-23T23:15:00', 'identifier': '', 'keywords': '', 'language': '', 'last_modified_by': '', 'last_printed': None, 'modified': '2013-12-23T23:15:00', 'revision': 1, 'subject': '', 'title': '', 'version': '', 'name': None, 'paragraphs': [], 'text': ''}, 'tokens': [], 'top_ngrams': []}
        self.assertEqual(result, expected_result)

if __name__ == "__main__":
    unittest.main()